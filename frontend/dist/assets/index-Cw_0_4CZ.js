import{r,j as e,h as i,t as b}from"./index-DTB5YGJN.js";import{A as q}from"./index-FtKvC6ry.js";import{F as p,C as y,I as g,s}from"./sweetalert.min-BjMBVopP.js";import{B as l}from"./button-4Hia_NiO.js";import{F as C}from"./Table-w_pEplYq.js";import{P as j,R as I}from"./index-D8ipjAbj.js";import{R as E}from"./EditOutlined-Dw4VbnlD.js";import"./index-D5VRFVwU.js";import"./index-B6thoTjc.js";import"./UserOutlined-Br0YFcVF.js";import"./ExclamationCircleFilled-DyzeEv2b.js";const{Item:m}=p;function L(){const[n]=p.useForm(),[x,c]=r.useState(!1),[w,B]=r.useState([]),[d,f]=r.useState(null),[o,h]=r.useState(0);r.useEffect(()=>{(async()=>{try{const t=i(),{data:u}=await t.get("/api/branch");B(u.data)}catch{s("Warning","Uanble to fetch data","warning")}})()},[o]);const N=async a=>{try{c(!0);let t=b(a);t.key=t.branchName,await i().post("/api/branch",t),s("Success","Branch Created","success"),n.resetFields(),h(o+1)}catch(t){t?.response?.data?.error?.code===11e3?n.setFields([{name:"branchName",errors:["Branch Already Exists !"]}]):s("Warning","Try again later","warning")}finally{c(!1)}},A=async a=>{f(a),n.setFieldsValue(a)},S=async a=>{try{c(!0);let t=b(a);await i().put(`/api/branch/${d._id}`,t),s("Success","Branch Update Successfully","success"),f(null),h(o+1),n.resetFields()}catch{s("Warning","Unable to update branch !","warning")}finally{c(!1)}},R=async a=>{try{await i().delete(`/api/branch/${a}`),s("Success","Branch Record Delete Successfully","success"),h(o+1)}catch{s("Warning","Unable to delete branch !","warning")}},F=[{title:"Branch Name",dataIndex:"branchName",key:"branchName"},{title:"Branch Address",dataIndex:"branchAddress",key:"branchAddress"},{title:"Action",key:"action",fixed:"right",render:(a,t)=>e.jsxs("div",{className:"flex gap-1",children:[e.jsx(j,{title:"Are You Sure?",description:"Once you update, you can also re-update !",onCancel:()=>s("Warning","No Changes Occur","warning"),onConfirm:()=>A(t),children:e.jsx(l,{type:"text",className:"!bg-green-100 !text-green-500",icon:e.jsx(E,{})})}),e.jsx(j,{title:"Are You Sure?",description:"Once you deleted, you can't restore !",onCancel:()=>s("Info","Your Data is Safe","info"),onConfirm:()=>R(t._id),children:e.jsx(l,{type:"text",className:"!bg-rose-100 !text-rose-500",icon:e.jsx(I,{})})})]})}];return e.jsx("div",{children:e.jsx(q,{children:e.jsxs("div",{className:"grid md:grid-cols-3 gap-3",children:[e.jsx(y,{title:"Add new branch",children:e.jsxs(p,{form:n,onFinish:d?S:N,layout:"vertical",children:[e.jsx(m,{label:"Branch Name",name:"branchName",rules:[{required:!0}],children:e.jsx(g,{})}),e.jsx(m,{label:"Branch Address",name:"branchAddress",children:e.jsx(g.TextArea,{})}),e.jsx(m,{children:d?e.jsx(l,{loading:x,type:"text",htmlType:"submit",className:"!bg-rose-500 !text-white !font-bold !w-full",children:"Update"}):e.jsx(l,{loading:x,type:"text",htmlType:"submit",className:"!bg-blue-500 !text-white !font-bold !w-full",children:"Submit"})})]})}),e.jsx(y,{style:{overflowX:"auto"},title:"Branch list",className:"md:col-span-2",children:e.jsx(C,{scroll:{x:"max-content"},columns:F,dataSource:w})})]})})})}export{L as default};
